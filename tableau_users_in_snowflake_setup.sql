----CREATE USER IN 

USE ROLE USERADMIN;


SET EMAIL = '<email>'; 

SET user_name   = '<user_name>';


CREATE OR REPLACE USER IDENTIFIER($user_name)
  LOGIN_NAME           = $user_name
  PASSWORD = '<a password>'
  --MUST_CHANGE_PASSWORD = TRUE
  DEFAULT_ROLE =  TABLEAU_USER_ROLE_TEST
  DEFAULT_WAREHOUSE = SNOWFLAKE_LEARNING_WH
  DEFAULT_NAMESPACE = SNOWFLAKE_LEARNING_DB.WORKSHOP_GOLD
  COMMENT = '<a comment>'
  EMAIL                = $EMAIL
  DAYS_TO_EXPIRY = 3;


--debug
SHOW USERS;


SELECT *
FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()))
WHERE "name" like '%<a pattern>%'
ORDER BY "created_on" DESC;




USE ROLE SECURITYADMIN;
GRANT ROLE TABLEAU_USER_ROLE TO USER IDENTIFIER($user_name);


USE ROLE SECURITYADMIN;
---drop USERs
SET TARGET_USER = ('<user_name>') ;
DROP USER IF EXISTS IDENTIFIER($TARGET_USER);
